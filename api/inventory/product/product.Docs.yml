paths:
  "/products":
    post:
      tags:
        - products
      summary: Crear un nuevo producto
      description: |
        Se crea un nuevo producto teniendo como parámetros las categorias 
        de familia, subfamilia, elemento y modelo.

        El servicio puede crear automaticamente estas categorias en caso no existan
        pero debe tenerse en cuenta las siguientes condiciones.
        - Para indicar que una categoria ya existe debe proporcionarse su Id. En caso no se 
        proporcione el Id, se considera que la categoría es nueva y se verificará que el nombre
        no exista en la DB.
        - En caso se proporcione el Id, el nombre enviado debe coincidir con el nombre de la 
        categoría existente.
        - Debe respetarse la jerarquía al momento de crear las categorías. El orden de creación
        es de arriba hacia abajo.
      operationId: addProduct
      responses:
        "201":
          description: Product created
        "400":
          description: Bad request
      requestBody:
        $ref: "#/components/requestBodies/Product"
    get:
      tags:
        - products
      summary: Listado de productos del inventario
      description: |
        Listar todos los productos del inventario. Existen filtros opcionales:
        - stock: Toma los valores 'yes': productos con stock disponible o 'all': todos los productos.
        - familyId, subfamilyId, elementId, modelId : Categorias de productos
        - code: Codigo de producto

      parameters:
        - $ref: "#/components/parameters/stock"
        - $ref: "#/components/parameters/code"
        - $ref: "#/components/parameters/familyId"
        - $ref: "#/components/parameters/subfamilyId"
        - $ref: "#/components/parameters/elementId"
        - $ref: "#/components/parameters/modelId"
        - $ref: "#/components/parameters/pagePagination"
        - $ref: "#/components/parameters/pageSizePagination"
      operationId: listProducts
      responses:
        "200":
          description: Products found
  "/products/{id}":
    get:
      tags:
        - products
      summary: Encontrar producto por Id incluyendo stock
      operationId: getProductById
      parameters:
        - $ref: "#/components/parameters/paramId"
      responses:
        "200":
          description: Successful operation
        "400":
          description: Invalid ID supplied
        "404":
          description: Resource not found
components:
  parameters:
    stock:
      name: stock
      in: query
      description: Indicador de si incluir productos con stock o todos
      required: false
      schema:
        type: string
        enum: ["yes", "all"]
    code:
      name: code
      in: query
      description: Código único de producto
      required: false
      schema:
        type: integer
        format: int32
        minimum: 1
    familyId:
      name: familyId
      in: query
      description: Id de la familia del producto
      required: false
      schema:
        type: integer
        format: int32
        minimum: 1
    subfamilyId:
      name: subfamilyId
      in: query
      description: Id de la subfamilia del producto
      required: false
      schema:
        type: integer
        format: int32
        minimum: 1
    elementId:
      name: elementId
      in: query
      description: Id del elemento del producto
      required: false
      schema:
        type: integer
        format: int32
        minimum: 1
    modelId:
      name: modelId
      in: query
      description: Id del modelo del producto
      required: false
      schema:
        type: integer
        format: int32
        minimum: 1

  requestBodies:
    Product:
      content:
        application/json:
          schema:
            type: object
            properties:
              familyId:
                type: string
                description: Id de la familia al que pertenece. Opcional para indicar que la familia existe.
              subfamilyId:
                type: string
                description: Id de la subfamilia al que pertenece. Opcional para indicar que la subfamilia existe.
              elementId:
                type: string
                description: Id del elemento al que pertenece. Opcional para indicar que el elemento existe.
              modelId:
                type: string
                description: Id del modelo al que pertenece. Opcional para indicar que el modelo existe.
              familyName:
                type: string
                description: Nombre de la familia al que pertenece.
              subfamilyName:
                type: string
                description: Nombre de la subfamilia al que pertenece.
              elementName:
                type: string
                description: Nombre del elemento al que pertenece.
              modelName:
                type: string
                description: Nombre del modelo al que pertenece.
              compatibility:
                type: string
                description: Marcas con los que es compatible el producto
              suggestedPrice:
                type: integer
                format: int32
                description: Precio sugerido. El valor debe ser entregado en centimos
            required:
              - familyName
              - subfamilyName
              - elementName
              - modelName
              - compatibility
              - suggestedPrice
          examples:
            Todo Nuevo:
              value:
                familyName: "Familia 1"
                subfamilyName: "Subfamilia 1"
                elementName: "Elemento 1"
                modelName: "Modelo 1"
                compatibility: "Compatible con todos"
                suggestedPrice: 10000
            Familia Existente:
              value:
                familyId: 1
                familyName: "Arrancador"
                subfamilyName: "Subfamilia 1"
                elementName: "Elemento 1"
                modelName: "Modelo 1"
                compatibility: "Compatible con todos"
                suggestedPrice: 10000
      required: true
